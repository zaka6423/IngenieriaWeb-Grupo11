{% extends 'core/base.html' %}

{% block title %}Inicio - Comedores Comunitarios{% endblock %}

{% block content %}
<!-- Hero Section Compacta con Efectos Avanzados -->
<section class="hero-section parallax-container dynamic-gradient particle-effect" style="position: relative; overflow: hidden; padding: 40px 0 30px 0; min-height: 300px;">
    <!-- Elementos decorativos de fondo con parallax -->
    <div class="parallax-bg"></div>
    <div class="parallax-shape"></div>
    <div class="parallax-shape"></div>
    <div class="parallax-shape"></div>
    
    <div class="container position-relative parallax-element">
        <div class="row align-items-center">
            <div class="col-lg-8 col-md-12 slide-in-left">
                <h1 class="display-5 fw-bold mb-3 text-white glow-effect text-center text-lg-start" style="text-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <span data-typewriter="Conectando Comunidades" data-speed="80"></span><br>
                    <span style="color: #FFF3E0; text-shadow: 0 2px 4px rgba(0,0,0,0.2);" data-typewriter="a través de la solidaridad" data-speed="100"></span>
                </h1>
                <p class="lead mb-4 text-white text-center text-lg-start" style="text-shadow: 0 1px 2px rgba(0,0,0,0.1); font-size: 1.1rem;">
                    Encontrá comedores comunitarios cerca tuyo, doná alimentos o sumate como voluntario.
                </p>
            </div>
            <div class="col-lg-4 col-md-12 text-center slide-in-right">
                <div class="feature-icon mx-auto parallax-floating pulse-glow" style="width: 100px; height: 100px; background: rgba(255, 255, 255, 0.15); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 2.5rem; backdrop-filter: blur(10px); border: 2px solid rgba(255, 255, 255, 0.2); box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
                    <i class="fas fa-hands-helping"></i>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Búsqueda Rápida Prominente -->
<section class="py-4" style="background: white; border-bottom: 1px solid #e9ecef;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10 col-12">
                <div class="text-center mb-3">
                    <h3 class="fw-bold mb-2" style="color: #2C3E50; font-size: 1.5rem;">¿Qué comedor estás buscando?</h3>
                    <p class="text-muted mb-0">Encuentra comedores por barrio, tipo o descripción</p>
                </div>
                <form action="{% url 'core:buscar' %}" method="GET" class="position-relative">
                    <div class="input-group input-group-custom">
                        <input type="text" name="q" class="form-control form-control-custom" placeholder="Buscar comedores, barrios, descripciones..." 
                               onfocus="this.parentElement.style.boxShadow='0 6px 25px rgba(0,0,0,0.15)'" 
                               onblur="this.parentElement.style.boxShadow='0 4px 20px rgba(0,0,0,0.1)'">
                        <button type="submit" class="btn btn-primary-custom">
                            <i class="fas fa-search me-2"></i><span class="d-none d-sm-inline">Buscar</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<!-- Comedores Destacados - Contenido Principal -->
<section class="py-5" style="background: linear-gradient(135deg, #FFF8F3, #FFF5F0);">
    <div class="container">
        <div class="row text-center mb-4">
            <div class="col-12">
                <h2 class="display-6 fw-bold mb-3" style="color: #2C3E50;">Comedores Comunitarios</h2>
                <p class="lead text-muted mb-4">Encontrá comedores cerca tuyo y sumate a nuestra red solidaria</p>
            </div>
        </div>
        
        {% if comedores_recientes %}
        <div class="row g-4 mb-5">
            {% for comedor in comedores_recientes %}
            <div class="col-lg-4 col-md-6 fade-in-up">
                <div class="card h-100 border-0 shadow-sm hover-lift hover-glow" style="background: white; border: 1px solid rgba(255, 107, 53, 0.1); border-radius: 15px; transition: all 0.3s ease;">
                    {% if comedor.imagen %}
                    <img src="{{ comedor.imagen.url }}" class="card-img-top" alt="{{ comedor.nombre }}" style="height: 200px; object-fit: cover; border-radius: 15px 15px 0 0;">
                    {% else %}
                    <div class="card-img-top d-flex align-items-center justify-content-center" style="height: 200px; background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 140, 66, 0.1)); border-radius: 15px 15px 0 0;">
                        <i class="fas fa-utensils icon-animated" style="font-size: 3rem; color: #FF6B35;"></i>
                    </div>
                    {% endif %}
                    <div class="card-body p-4">
                        <h5 class="fw-bold mb-2" style="color: #2C3E50;">{{ comedor.nombre }}</h5>
                        <p class="text-muted mb-3">
                            <i class="fas fa-map-marker-alt me-2 icon-animated" style="color: #FF6B35;"></i>
                            {{ comedor.barrio }}
                        </p>
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="badge badge-enhanced 
                                {% if comedor.tipo == 'Comunitario' %}status-disponible{% endif %}
                                {% if comedor.tipo == 'Parroquial' %}status-disponible{% endif %}
                                {% if comedor.tipo == 'Municipal' %}status-disponible{% endif %}
                                {% if comedor.tipo == 'ONG' %}status-urgente{% endif %}
                                {% if comedor.tipo == 'Cooperativa' %}status-limitado{% endif %}
                                {% if comedor.tipo == 'Barrial' %}status-disponible{% endif %}
                                {% if comedor.tipo == 'Religioso' %}status-disponible{% endif %}
                                {% if comedor.tipo == 'Social' %}status-urgente{% endif %}
                                {% if comedor.tipo == 'Otro' %}status-limitado{% endif %}">
                                <span class="icon-comedor {{ comedor.tipo|lower }}"></span>{{ comedor.tipo }}
                            </span>
                            <small class="text-muted">
                                <i class="fas fa-users me-1 icon-animated"></i>{{ comedor.capacidad }} personas
                            </small>
                        </div>
                        <p class="text-muted small mb-3">{{ comedor.descripcion|truncatewords:15 }}</p>
                        <a href="{% url 'core:detalle_comedor' comedor.pk %}" class="btn btn-primary-custom w-100 btn-hover-enhanced">
                            <i class="fas fa-eye me-2"></i>Ver detalles
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Call to Action Principal -->
        <div class="row">
            <div class="col-12 text-center">
                <a href="{% url 'core:listar_comedores' %}" class="btn btn-primary-custom btn-lg" style="font-size: 1.1rem;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(255, 107, 53, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <i class="fas fa-list me-2"></i>Mirá Todos los Comedores
                </a>
                {% if user.is_authenticated %}
                <a href="{% url 'core:crear_comedor' %}" class="btn btn-secondary-custom btn-lg ms-3" style="font-size: 1.1rem;">
                    <i class="fas fa-plus me-2"></i>Sumar Comedor
                </a>
                {% endif %}
            </div>
        </div>
        {% else %}
        <div class="row">
            <div class="col-12 text-center">
                <div class="py-5">
                    <div class="feature-icon mx-auto mb-4" style="width: 100px; height: 100px; background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 140, 66, 0.1)); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #FF6B35; font-size: 3rem;">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <h4 class="text-muted mb-3">Aún no hay comedores registrados</h4>
                    <p class="text-muted mb-4">Sé el primero en agregar un comedor comunitario</p>
                    {% if user.is_authenticated %}
                    <a href="{% url 'core:crear_comedor' %}" class="btn btn-primary-custom btn-lg">
                        <i class="fas fa-plus me-2"></i>Crear Primer Comedor
                    </a>
                    {% else %}
                    <a href="{% url 'registro' %}" class="btn btn-primary-custom btn-lg">
                        <i class="fas fa-user-plus me-2"></i>Registrarse para Crear
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<!-- Sección de Características con Cards Flip (Después de Comedores) -->
<section class="py-4" style="background: linear-gradient(135deg, #FFF8F3, #FFF5F0);">
    <div class="container">
        <div class="row text-center mb-4">
            <div class="col-12">
                <h2 class="h3 fw-bold mb-2 slide-in-up" style="color: #2C3E50;">¿Por qué elegirnos?</h2>
                <p class="text-muted slide-in-up">Características que nos hacen únicos</p>
            </div>
        </div>
        
        <div class="row g-3">
            <div class="col-lg-4 col-md-6 col-12">
                <div class="flip-card hover-lift" style="height: 200px;">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <i class="fas fa-heart mb-2" style="font-size: 2rem;"></i>
                            <h4 class="h5">Solidaridad</h4>
                            <p class="small">Conectamos barrios</p>
                        </div>
                        <div class="flip-card-back">
                            <i class="fas fa-users mb-2" style="font-size: 2rem;"></i>
                            <h4 class="h5">Comunidad</h4>
                            <p class="small"><span data-counter="{{ comedores_count }}">{{ comedores_count }}</span> comedores registrados</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 col-12">
                <div class="flip-card hover-lift" style="height: 200px;">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <i class="fas fa-map-marker-alt mb-2" style="font-size: 2rem;"></i>
                            <h4 class="h5">Proximidad</h4>
                            <p class="small">Encontrá comedores cerca tuyo</p>
                        </div>
                        <div class="flip-card-back">
                            <i class="fas fa-clock mb-2" style="font-size: 2rem;"></i>
                            <h4 class="h5">Cobertura</h4>
                            <p class="small"><span data-counter="{{ barrios_count }}">{{ barrios_count }}</span> barrios cubiertos</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 col-12">
                <div class="flip-card hover-lift" style="height: 200px;">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <i class="fas fa-hand-holding-heart mb-2" style="font-size: 2rem;"></i>
                            <h4 class="h5">Donaciones</h4>
                            <p class="small">Te ayudamos a donar</p>
                        </div>
                        <div class="flip-card-back">
                            <i class="fas fa-chart-line mb-2" style="font-size: 2rem;"></i>
                            <h4 class="h5">Impacto</h4>
                            <p class="small"><span data-counter="{{ total_capacity }}">{{ total_capacity }}</span> personas pueden ser ayudadas</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section Compacta -->
<section class="py-4" style="background: linear-gradient(135deg, #FFF8F3, #FFF5F0);">
    <div class="container">
        <div class="row text-center mb-4">
            <div class="col-lg-8 mx-auto">
                <h3 class="fw-bold mb-2" style="color: #2C3E50;">¿Cómo funciona?</h3>
                <p class="text-muted mb-0">Conectamos a gente que necesita ayuda con aquellos que quieren dar una mano</p>
            </div>
        </div>
        
        <div class="row g-3">
            <div class="col-lg-4">
                <div class="card h-100 text-center p-3" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); color: white; border: none; border-radius: 12px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 30px rgba(255, 107, 53, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 5px 20px rgba(0, 0, 0, 0.1)'">
                    <div class="feature-icon" style="width: 60px; height: 60px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 1.5rem;">
                        <i class="fas fa-search"></i>
                    </div>
                    <h5 class="fw-bold mb-2" style="color: var(--text-primary);">Encontrá comedores</h5>
                    <p style="color: var(--text-primary); font-size: 0.9rem;">Buscá comedores comunitarios cerca tuyo</p>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="card h-100 text-center p-3" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); color: white; border: none; border-radius: 12px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 30px rgba(255, 107, 53, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 5px 20px rgba(0, 0, 0, 0.1)'">
                    <div class="feature-icon" style="width: 60px; height: 60px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 1.5rem;">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h5 class="fw-bold mb-2" style="color: var(--text-primary);">Doná alimentos</h5>
                    <p style="color: var(--text-primary); font-size: 0.9rem;">Contribuí con alimentos para apoyar a las familias</p>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="card h-100 text-center p-3" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); color: white; border: none; border-radius: 12px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 30px rgba(255, 107, 53, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 5px 20px rgba(0, 0, 0, 0.1)'">
                    <div class="feature-icon" style="width: 60px; height: 60px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 1.5rem;">
                        <i class="fas fa-users"></i>
                    </div>
                    <h5 class="fw-bold mb-2" style="color: var(--text-primary);">Sumate como voluntario</h5>
                    <p style="color: var(--text-primary); font-size: 0.9rem;">Unite como voluntario para dar una mano</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Call to Action Final -->
<section class="py-4" style="background: linear-gradient(135deg, var(--light-orange), var(--warm-orange));">
    <div class="container">
        <div class="row text-center">
            <div class="col-lg-8 mx-auto">
                <h3 class="fw-bold mb-3 text-white">¿Listo para hacer la diferencia?</h3>
                <p class="mb-3 text-white">Cada pequeña acción cuenta. Unite a nuestra comunidad solidaria.</p>
                {% if not user.is_authenticated %}
                    <a href="{% url 'registro' %}" class="btn btn-primary-custom btn-lg" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(255, 107, 53, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <i class="fas fa-user-plus me-2"></i>Registrarse gratis
                    </a>
                {% else %}
                    <div class="welcome-message">
                        <h4 class="mb-2">¡Bienvenido, {{ user.username }}!</h4>
                        <p class="mb-0">Gracias por ser parte de nuestra comunidad solidaria.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endblock %}
