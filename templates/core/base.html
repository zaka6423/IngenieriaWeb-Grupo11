{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Comedores comunitarios{% endblock %}</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS - Cargado ANTES de los estilos inline -->
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">
    
    <style>
        :root {
            --primary-orange: #FF6B35;
            --secondary-orange: #FF8C42;
            --warm-orange: #FFA726;
            --light-orange: #FFE0B2;
            --dark-orange: #E65100;
            --text-dark: #2C3E50;
            --text-light: #7F8C8D;
            --white: #FFFFFF;
            --light-gray: #F8F9FA;
        }

        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-dark);
            background-color: var(--light-gray);
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-orange), var(--secondary-orange)) !important;
            box-shadow: 0 2px 10px rgba(255, 107, 53, 0.3);
        }

        .navbar-brand {
            font-weight: 700;
            color: var(--white) !important;
            font-size: 1.5rem;
        }

        .navbar-nav .nav-link {
            color: var(--white) !important;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .navbar-nav .nav-link:hover {
            color: var(--light-orange) !important;
            transform: translateY(-2px);
        }

        .hero-section {
            background: linear-gradient(135deg, var(--primary-orange), var(--secondary-orange));
            color: var(--white);
            padding: 100px 0;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.1"/><circle cx="10" cy="60" r="0.5" fill="white" opacity="0.1"/><circle cx="90" cy="40" r="0.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        }

        .stats-card {
            background: linear-gradient(135deg, var(--primary-orange), var(--secondary-orange));
            color: var(--white);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
        }

        .stats-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .stats-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .hero-section {
                padding: 60px 0;
            }
            
            .form-container {
                padding: 30px 20px;
            }
        }
        
        /* Estilos para modo oscuro */
        .dark-mode {
            background-color: #1a1a1a !important;
            color: #ffffff !important;
        }
        
        .dark-mode .bg-white {
            background-color: #2d2d2d !important;
            color: #ffffff !important;
        }
        
        .dark-mode .card {
            background-color: #2d2d2d !important;
            border-color: #404040 !important;
        }
        
        .dark-mode .text-muted {
            color: #b0b0b0 !important;
        }
        
        .dark-mode .bg-light {
            background-color: #2d2d2d !important;
        }
        
        /* Mejoras para menú móvil */
        @media (max-width: 991px) {
            .navbar-collapse {
                background: rgba(255, 107, 53, 0.95);
                border-radius: 10px;
                margin-top: 10px;
                padding: 20px;
                backdrop-filter: blur(10px);
            }
            
            .navbar-nav .nav-item {
                margin-bottom: 10px;
            }
            
            .navbar-nav .nav-link {
                padding: 12px 20px;
                border-radius: 8px;
                transition: all 0.3s ease;
            }
            
            .navbar-nav .nav-link:hover {
                background: rgba(255, 255, 255, 0.1);
                transform: translateX(5px);
            }
        }

        /* Estilos mejorados para mensajes */
        .alert {
            border-left: 4px solid;
            animation: slideInDown 0.5s ease-out;
        }

        .alert-success {
            border-left-color: #28a745;
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
        }

        .alert-danger {
            border-left-color: #dc3545;
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
        }

        .alert-warning {
            border-left-color: #ffc107;
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
        }

        .alert-info {
            border-left-color: #17a2b8;
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Mejoras para campos de formulario con errores */
        .is-invalid {
            border-color: #dc3545 !important;
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
        }

        .invalid-feedback {
            display: block !important;
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        /* Estilos para modo oscuro en mensajes */
        .dark-mode .alert-success {
            background: linear-gradient(135deg, #1e4d2b, #2d5a3d);
            color: #d4edda;
        }

        .dark-mode .alert-danger {
            background: linear-gradient(135deg, #4d1e1e, #5a2d2d);
            color: #f8d7da;
        }

        .dark-mode .alert-warning {
            background: linear-gradient(135deg, #4d3e1e, #5a4d2d);
            color: #fff3cd;
        }

        .dark-mode .alert-info {
            background: linear-gradient(135deg, #1e3d4d, #2d4a5a);
            color: #d1ecf1;
        }
    </style>
</head>
<body>
    <!-- Sistema de mensajes - Movido arriba de la navbar -->
    {% if messages %}
        <div class="container-fluid mt-0 pt-2" style="background: rgba(255, 255, 255, 0.95); z-index: 1050; position: relative;">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show" role="alert">
                    <div class="d-flex align-items-center">
                        {% if message.tags == 'success' %}
                            <i class="fas fa-check-circle me-3 text-success"></i>
                        {% elif message.tags == 'error' %}
                            <i class="fas fa-exclamation-triangle me-3 text-danger"></i>
                        {% elif message.tags == 'warning' %}
                            <i class="fas fa-exclamation-circle me-3 text-warning"></i>
                        {% elif message.tags == 'info' %}
                            <i class="fas fa-info-circle me-3 text-info"></i>
                        {% else %}
                            <i class="fas fa-bell me-3 text-secondary"></i>
                        {% endif %}
                        <div class="flex-grow-1">
                            <strong>{{ message }}</strong>
                        </div>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="{% url 'core:home' %}">
                <i class="fas fa-utensils me-2"></i>
                Comedores comunitarios
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'core:home' %}">
                            <i class="fas fa-home me-1"></i>Inicio
                        </a>
                    </li>
                    <!-- Toggle de modo oscuro -->
                    <li class="nav-item me-3">
                        <button id="darkModeToggle" class="btn btn-outline-light btn-sm" style="border-radius: 20px; padding: 8px 16px; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='transparent'">
                            <i class="fas fa-moon me-1"></i>Modo oscuro
                        </button>
                    </li>
                    
                    {% if user.is_authenticated %}
                        <li class="nav-item">
                            <a class="nav-link position-relative" href="{% url 'core:privada' %}">
                                <i class="fas fa-user me-1"></i>Mi perfil
                                {% if not user.userprofile.email_verified %}
                                    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning text-dark" style="font-size: 0.6rem;">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </span>
                                {% endif %}
                            </a>
                        </li>
                        {% if user.is_staff %}
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/">
                                <i class="fas fa-cog me-1"></i>Administración
                            </a>
                        </li>
                        {% endif %}
                        <li class="nav-item">
                            <form action="{% url 'logout' %}" method="post" class="d-inline">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-outline-light btn-sm">
                                    <i class="fas fa-sign-out-alt me-1"></i>Cerrar sesión
                                </button>
                            </form>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'login' %}">
                                <i class="fas fa-sign-in-alt me-1"></i>Iniciar sesión
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'registro' %}">
                                <i class="fas fa-user-plus me-1"></i>Registrarse
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer mt-5" style="background: linear-gradient(135deg, #2C3E50, #34495E); color: white; padding: 3rem 0; margin-top: 0; border-top: 4px solid #FF6B35; min-height: 120px; display: flex; align-items: center;">
        <div class="container" style="display: flex; align-items: center;">
            <div class="row" style="width: 100%; align-items: center;">
                <div class="col-md-4">
                    <h5 style="color: white; margin-bottom: 0; font-size: 1.25rem; font-weight: 600;"><i class="fas fa-utensils me-2"></i>Comedores comunitarios</h5>
                    <p class="mb-0" style="color: white; font-size: 0.9rem; opacity: 0.9;">Conectando comunidades a través de la solidaridad y el apoyo mutuo.</p>
                </div>
                
                <!-- Newsletter Signup -->
                <div class="col-md-4">
                    <h6 style="color: white; margin-bottom: 1rem; font-weight: 600;">Suscribite a nuestro boletín</h6>
                    <form class="d-flex" style="max-width: 300px;">
                        <input type="email" class="form-control me-2" placeholder="Tu email" style="border-radius: 20px 0 0 20px; border: none; padding: 8px 15px; font-size: 0.9rem;">
                        <button type="submit" class="btn" style="background: #FF6B35; color: white; border: none; border-radius: 0 20px 20px 0; padding: 8px 15px; font-size: 0.9rem; transition: all 0.3s ease;" onmouseover="this.style.background='#E65100'" onmouseout="this.style.background='#FF6B35'">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                    <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem;">Recibí noticias sobre nuevos comedores y eventos</small>
                </div>
                
                <div class="col-md-4 text-md-end">
                    <p class="mb-0" style="color: white; font-size: 0.9rem; opacity: 0.9;">&copy; 2025 Comedores Comunitarios. Todos los derechos reservados. Apoca, Caluva, Saliva.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="{% static 'js/custom.js' %}"></script>
    <script src="{% static 'js/stats.js' %}"></script>
    <script src="{% static 'js/darkMode.js' %}"></script>
    <script src="{% static 'js/mobileMenu.js' %}"></script>
    <script src="{% static 'js/messages.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>
